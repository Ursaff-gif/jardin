<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Simulateur de jardin</title>
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      background-color: #ffffff;
      margin: 0;
      padding: 10px;
    }

    .toolbar {
      margin-bottom: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .toolbar button, .upload-label, .save-btn {
      background-color: #95de8f;
      color: #3f2c32;
      font-weight: bold;
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
    }

    .upload-label {
      margin-right: auto;
    }

    #imageUpload {
      display: none;
    }

    .simulator-container {
      width: 100%;
      height: 540px;
      border: 2px solid #7e9884;
      background-color: #dfebd7;
      position: relative;
      overflow: hidden;
    }

    #background {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }

    .plant {
      width: 70px;
      position: absolute;
      cursor: grab;
      z-index: 2;
    }

    .plant:hover::after {
      content: "ðŸ›’";
      position: absolute;
      bottom: -20px;
      left: 0;
      background: #fff;
      border-radius: 4px;
      font-size: 12px;
      padding: 2px 5px;
    }

    .message {
      font-size: 14px;
      color: #3f2c32;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <label class="upload-label" for="imageUpload">ðŸ“· Importer mon jardin</label>
    <input type="file" id="imageUpload" accept="image/*">

    <button onclick="addPlant('https://www.freeiconspng.com/uploads/plant-png-22.png')">ðŸŒ¿ Plante</button>
    <button onclick="addPlant('https://www.freeiconspng.com/uploads/plant-png-5.png')">ðŸŒ¼ Fleur</button>
    <button onclick="addPlant('https://www.freeiconspng.com/uploads/olive-tree-png-31.png')">ðŸŒ³ Arbre</button>

    <button class="save-btn" onclick="saveAsImage()">ðŸ“¸ Sauvegarder</button>
  </div>

  <div class="simulator-container" id="simulator">
    <img id="background" src="" alt="Votre jardin ici" />
  </div>

  <div class="message" id="message"></div>

  <script>
    let selected = null;
    let simulator = document.getElementById('simulator');
    let message = document.getElementById('message');

    simulator.addEventListener('mousedown', function (e) {
      if (e.target.classList.contains('plant')) {
        selected = e.target;
      }
    });

    simulator.addEventListener('mousemove', function (e) {
      if (selected) {
        selected.style.left = e.offsetX - 35 + 'px';
        selected.style.top = e.offsetY - 35 + 'px';
      }
    });

    document.addEventListener('mouseup', function () {
      selected = null;
    });

    function addPlant(src) {
      const plant = document.createElement('img');
      plant.src = src;
      plant.classList.add('plant');
      plant.style.top = '50px';
      plant.style.left = '50px';
      plant.onclick = () => {
        message.textContent = "âœ… Plante ajoutÃ©e au panier.";
        setTimeout(() => message.textContent = '', 2000);
      };
      simulator.appendChild(plant);
    }

    document.getElementById('imageUpload').addEventListener('change', function (e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function (event) {
        document.getElementById('background').src = event.target.result;
      };
      reader.readAsDataURL(file);
    });

    function saveAsImage() {
      html2canvas(simulator).then(canvas => {
        const link = document.createElement('a');
        link.download = 'mon-jardin.png';
        link.href = canvas.toDataURL();
        link.click();
      });
    }
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
